I"í7<h1 id="chapter-1--cÃ¡c-cÃ´ng-cá»¥-lÃ m-viá»‡c-trong-máº£ng-data-engineering">Chapter 1 : CÃ¡c cÃ´ng cá»¥ lÃ m viá»‡c trong máº£ng Data Engineering</h1>

<h2 id="i-database">I. Database</h2>

<h3 id="1-database-lÃ -gÃ¬">1. Database lÃ  gÃ¬?</h3>

<p>Database lÃ  táº­p há»£p dá»¯ liá»‡u lá»›n Ä‘Æ°á»£c tá»• chá»©c Ä‘áº·c biá»‡t Ä‘á»ƒ tÃ¬m kiáº¿m vÃ  rÃºt trÃ­ch dá»¯ liá»‡u nhanh.</p>

<p><img src="img/database.png" alt="" /></p>

<p>CÃ¡c Ä‘áº·c Ä‘iá»ƒm cá»§a nÃ³:</p>
<ul>
  <li>LÆ°u trá»¯ dá»¯ liá»‡u</li>
  <li>Tá»• chá»©c dá»¯ liá»‡u</li>
  <li>RÃºt trÃ­ch/TÃ¬m kiáº¿n dá»¯ liá»‡u thÃ´ng qua DBMS</li>
</ul>

<h3 id="2-phÃ¢n-biá»‡t-dá»¯-liá»‡u-cÃ³-cáº¥u-trÃºc-vÃ -dá»¯-liá»‡u-khÃ´ng-cáº¥u-trÃºc">2. PhÃ¢n biá»‡t dá»¯ liá»‡u <strong>cÃ³ cáº¥u trÃºc</strong> vÃ  dá»¯ liá»‡u <strong>khÃ´ng cáº¥u trÃºc</strong></h3>

<h4 id="cÃ³-cáº¥u-trÃºc">CÃ³ cáº¥u trÃºc:</h4>
<p>Database cÃ³ schema, vÃ­ dá»¥ nhÆ° cÃ¡c relational database</p>

<h4 id="bÃ¡n-cáº¥u-trÃºc-semi-structured">BÃ¡n cáº¥u trÃºc (semi-structured):</h4>
<p>VÃ­ dá»¥ nhÆ° file JSON</p>
<pre><code> { â€œkeyâ€ : â€œvalueâ€ }
</code></pre>

<h4 id="khÃ´ng-cáº¥u-trÃºc">KhÃ´ng cáº¥u trÃºc:</h4>
<p>KhÃ´ng cÃ³ schema, giá»‘ng nhÆ° cÃ¡c táº­p tin : videos, hÃ¬nh áº£nh</p>

<h3 id="3-phÃ¢n-biá»‡t-sql-vÃ -nosql">3. PhÃ¢n biá»‡t SQL vÃ  NoSQL</h3>
<h4 id="sql-database-cÃ³-nhá»¯ng-Ä‘áº·c-Ä‘iá»ƒm-sau">SQL database cÃ³ nhá»¯ng Ä‘áº·c Ä‘iá»ƒm sau:</h4>
<ul>
  <li>CÃ³ cÃ¡c báº£ng Ä‘á»ƒ truy váº¥n</li>
  <li>CÃ³ Database schema (xÃ¡c Ä‘á»‹nh sá»± liÃªn há»‡ vÃ  thuá»™c tÃ­nh cá»§a database)</li>
  <li>CÃ³ cÃ¡c Relational database (cÃ³ quan há»‡ vá»›i nhau)</li>
  <li>CÃ¡c há»‡ quáº£n trá»‹ cÆ¡ sá»Ÿ dá»¯ liá»‡u phá»• biáº¿n cá»§a ngÃ´n ngá»¯ nÃ y: MySQL, PostgreSQL</li>
</ul>

<h4 id="nosql-database-cÃ³-nhá»¯ng-Ä‘áº·c-Ä‘iá»ƒm-sau">NoSQL database cÃ³ nhá»¯ng Ä‘áº·c Ä‘iá»ƒm sau:</h4>
<ul>
  <li>CÃ³ cÃ¡c Non-relational database</li>
  <li>ThÆ°á»ng gáº¯n vá»›i cÃ¡c dá»¯ liá»‡u khÃ´ng cÃ³ schema (unstructured), nhÆ°ng Ä‘Ã´i khi cÃ³ cÃ¡c dá»¯ liá»‡u cÃ³ schema (structured)</li>
  <li>LÆ°u trá»¯ cÃ¡c cáº·p key-value (e.g. dÃ¹ng cho caching hoáº·c cáº¥u hÃ¬nh phÃ¢n tÃ¡n â€œdistributed configurationâ€)</li>
  <li>Nhá»¯ng á»©ng dá»¥ng thÆ°á»ng dÃ¹ng NoSQL lÃ  nhá»¯ng á»©ng dá»¥ng chá»©a cáº·p key-value nhÆ° Redis hoáº·c MongoDB cÃ³ model lÃ  document database.</li>
</ul>

<p>*CÃ¡c giÃ¡ trá»‹ trong document database thÆ°á»ng lÃ  cÃ¡c object cÃ³ cáº¥u trÃºc hoáº·c bÃ¡n cáº¥u trÃºc, vÃ­ dá»¥ nhÆ° JSON object.</p>

<h3 id="4-sql-tÃ¬m-hiá»ƒu-vá»-database-chema">4. SQL: TÃ¬m hiá»ƒu vá» Database chema</h3>

<h4 id="database-schema-cÃ³-vai-trÃ²-gÃ¬">Database schema cÃ³ vai trÃ² gÃ¬?</h4>
<blockquote>
  <p>CÃ³ nhiá»‡m vá»¥ mÃ´ táº£ cáº¥u trÃºc vÃ  cÃ¡c má»‘i quan há»‡ cá»§a cÃ¡c báº£ng trong database thÃ´ng qua SQL code vÃ  sÆ¡ Ä‘á»“ schema</p>
</blockquote>

<h3 id="star-schema">Star schema</h3>
<p>Trong datawarehouse database, thÆ°á»ng nhá»¯ng schema chÃºng ta tháº¥y lÃ  star schema cÃ³ sÆ¡ Ä‘á»“ giá»‘ng nhÆ° hÃ¬nh ngÃ´i sao.</p>

<p>Fact table á»Ÿ giá»¯a vÃ  xung quanh lÃ  cÃ¡c Dimension tables, trong Ä‘Ã³:</p>
<ul>
  <li>Fact table: lÃ  table chá»©a cÃ¡c dá»¯ liá»‡u xáº£y ra trÃªn tháº¿ giá»›i nhÆ° product orders, v.v</li>
  <li>Dimension table: lÃ  cÃ¡c table mang thuá»™c tÃ­nh Ä‘á»ƒ mÃ´ táº£ cho fact table nhÆ° mÃ u sáº¯c, kÃ­ch thÆ°á»›c, v.v</li>
</ul>

<p>TÃ¬m hiá»ƒu thÃªm vá» Star chema <a href="https://en.wikipedia.org/wiki/Star_schema">táº¡i Ä‘Ã¢y</a></p>

<p><em>VÃ­ dá»¥ thá»±c táº¿:</em>
Giáº£ sá»­ ta cÃ³ database mÃ´ táº£ cáº¥u trÃºc dá»¯ liá»‡u cho há»‡ thá»‘ng bÃ¡n hÃ ng á»Ÿ 1 cá»­a hÃ ng quáº§n Ã¡o:
<img src="img/star-chema.png" alt="" /></p>

<p>Giáº£ sá»­ ta cÃ³ báº£ng invoice lÆ°u dá»¯ liá»‡u bÃ¡n hÃ ng (fact table) cÃ³ cÃ¡c cá»™t sau:</p>

<table>
  <thead>
    <tr>
      <th>id (primary key)</th>
      <th>created_date_time</th>
      <th>items_id</th>
      <th>payment_method</th>
      <th>customer_id</th>
      <th>card_id</th>
      <th>Â </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>123</td>
      <td>12:00:00</td>
      <td>12/12/2021</td>
      <td>1</td>
      <td>Bank</td>
      <td>111</td>
      <td>9116</td>
    </tr>
  </tbody>
</table>

<p>Ta sáº½ cÃ³ cÃ¡c báº£ng dimension sau Ä‘á»ƒ báº£ng invoice liÃªn káº¿t má»‘i quan há»‡ nháº±m mÃ´ táº£ chi tiáº¿t cÃ¡c giao dá»‹ch invoice:</p>

<p>Báº£ng Item</p>

<table>
  <thead>
    <tr>
      <th>id</th>
      <th>item_name</th>
      <th>category</th>
      <th>color</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Quáº§n Ä‘Ã¹i lá»­ng</td>
      <td>Quáº§n</td>
      <td>Äen</td>
      <td>200000</td>
    </tr>
  </tbody>
</table>

<p>Báº£ng Customer</p>

<table>
  <thead>
    <tr>
      <th>id</th>
      <th>name</th>
      <th>birthday</th>
      <th>card_id</th>
      <th>is_valid</th>
      <th>num_of_orders</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>111</td>
      <td>Thanh Tuyá»n</td>
      <td>09/XX/XXXX</td>
      <td>9116</td>
      <td>0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>

<p>Báº£ng Card</p>

<table>
  <thead>
    <tr>
      <th>id</th>
      <th>customer_id</th>
      <th>point</th>
      <th>expired_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>9116</td>
      <td>111</td>
      <td>2100</td>
      <td>31/12/2025</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="ii-parallel-computing">II. Parallel computing</h2>

<h3 id="parallel-computing-lÃ -gÃ¬">Parallel computing lÃ  gÃ¬?</h3>

<p>TrÆ°á»›c tiÃªn ta Ä‘i tá»« Ã½ tÆ°á»Ÿng cá»§a viá»‡c táº¡o ra parallel computing.</p>
<ul>
  <li>NÃ³ hÃ¬nh thÃ nh nÃªn ná»n mÃ³ng cho cÃ¡c cÃ´ng cá»¥ xá»­ lÃ½ data hiá»‡n Ä‘áº¡i (data processing tool)</li>
  <li>Tuy nhiÃªn lÃ­ do quan trá»ng nháº¥t pháº£i nÃ³i Ä‘áº¿n lÃ  Ä‘á»ƒ tá»‘i Æ°u <strong>Bá»™ nhá»› vÃ  hiá»‡u nÄƒng xá»­ lÃ½ dá»¯ liá»‡u</strong></li>
</ul>

<h4 id="cÃ¡ch-thá»©c-hoáº¡t-Ä‘á»™ng">CÃ¡ch thá»©c hoáº¡t Ä‘á»™ng:</h4>
<ul>
  <li>Chia task thÃ nh nhiá»u task phá»¥</li>
  <li>PhÃ¢n tÃ¡n task phá»¥ trÃªn má»™t vÃ i mÃ¡y tÃ­nh (thÆ°á»ng lÃ  cÃ¡c <a href="https://whatis.techtarget.com/definition/commodity-computer#:~:text=A%20commodity%20computer%20is%20a,no%2Dfrills%20but%20functional%20machines.">commodity computer</a> hoáº·c Ä‘Ã£ cÃ³ sáºµn Ä‘á»ƒ Ã­t tá»‘n phÃ­ thay vÃ¬ sá»­ dá»¥ng cÃ¡c siÃªu mÃ¡y tÃ­nh)</li>
  <li>CÃ¡c mÃ¡y tÃ­nh lÃ m viá»‡c song song vá»›i nhau trÃªn cÃ¡c task phá»¥, do Ä‘Ã³ cÃ¡c task Ä‘Æ°á»£c hoÃ n thÃ nh nhanh hÆ¡n</li>
</ul>

<p>ChÃºng ta hÃ£y cÃ¹ng xem vÃ­ dá»¥ váº­n hÃ nh shop may Ä‘á»“:</p>

<p><img src="img/tailorshop.png" alt="" /></p>

<p>Äáº·t má»¥c tiÃªu may 100 cÃ¡i Ã¡o, thÃ¬ shop nháº­n tháº¥y:</p>
<ul>
  <li>NhÃ¢n viÃªn may giá»i nháº¥t nhÃ³m may 1 cÃ¡i Ã¡o trong 20 phÃºt =&gt; 12 cÃ¡i Ã¡o trong 4 tiáº¿ng</li>
  <li>Nhá»¯ng nhÃ¢n viÃªn khÃ¡c thÃ¬ may 1 cÃ¡i Ã¡o trong 1 tiáº¿ng</li>
</ul>

<p>Sau khi Ã¡p dá»¥ng mÃ´ hÃ¬nh parallel báº±ng cÃ¡ch:</p>
<ul>
  <li>Chia ra 4 chu ká»³</li>
  <li>Má»—i chu kÃ¬ 25 cÃ¡i Ã¡o vÃ  4 nhÃ¢n viÃªn may lÃ m viá»‡c song song
ThÃ¬ ta tháº¥y Ä‘Æ°á»£c náº¿u cÃ¡c nhÃ¢n viÃªn may cÃ³ kháº£ nÄƒng tháº¥p hÆ¡n khi cÃ¹ng lÃ m viá»‡c song song vá»›i nhau thÃ¬ sáº½ lÃ m Ä‘Æ°á»£c 16 cÃ¡i Ã¡o trong 4 tiáº¿ng.</li>
</ul>

<p>NÃ³i vá» thá»±c táº¿ mÃ¡y tÃ­nh, 4 nhÃ¢n viÃªn may cÃ³ nÄƒng lá»±c tháº¥p hÆ¡n thÃ¬ sáº½ giá»‘ng nhÆ° lÃ  cÃ¡c mÃ¡y tÃ­nh cÃ³ sáºµn, Ã­t tá»‘n phÃ­, thay vÃ¬ ta pháº£i thuÃª 1 nhÃ¢n viÃªn giá»i hay cÃ³ thá»ƒ nÃ³i lÃ  siÃªu mÃ¡y tÃ­nh thÃ¬ chi phÃ­ sáº½ cao hÆ¡n nhiá»u nhÆ°ng khÃ´ng cháº¯c cháº¯c hiá»‡u quáº£ báº±ng.</p>

<p>TÃ³m láº¡i, lá»£i Ã­ch cá»§a parallel computing:</p>
<ul>
  <li>Hiá»‡u suáº¥t xá»­ lÃ½</li>
  <li>Bá»™ nhá»›: chia dá»¯ liá»‡u thÃ nh cÃ¡c táº­p há»£p con vÃ  Ä‘Æ°a vÃ o bá»™ nhá»› cá»§a cÃ¡c mÃ¡y tÃ­nh khÃ¡c nhau
=&gt; má»©c chiáº¿m dá»¥ng bá»™ nhá»› tÆ°Æ¡ng Ä‘á»‘i nhá» vÃ  dá»¯ liá»‡u Ä‘Æ°á»£c Ä‘Æ°a vÃ o trong bá»™ nhá»› gáº§n RAM nháº©t</li>
</ul>

<h4 id="nhá»¯ng-rá»§i-ro-khi-Ã¡p-dá»¥ng">Nhá»¯ng rá»§i ro khi Ã¡p dá»¥ng</h4>
<p><strong>Overhead due to communication</strong></p>
<ul>
  <li>YÃªu cáº§u chÆ°a Ä‘á»§ lá»›n Ä‘á»ƒ Ã¡p dá»¥ng</li>
  <li>Cáº§n nhiá»u processing units hÆ¡n</li>
  <li>ÄÃ´i khi tÃ¡ch ra sáº½ gáº·p váº¥n Ä‘á» vá» program runtime, yÃªu cáº§u tá»‘n nhiá»u thá»i gian Ä‘á»ƒ xá»­ lÃ½ giao tiáº¿p giá»¯a cÃ¡c processes hÆ¡n so vá»›i khÃ´ng tÃ¡ch ra. Viá»‡c cÃ³ nhiá»u chÆ°Æ¡ng trÃ¬nh hÆ¡n sáº½ khiáº¿n thá»i gian contact switch giá»¯a cÃ¡c chÆ°Æ¡ng trÃ¬nh nhiá»u hÆ¡n khÃ´ng phÃ¹ há»£p khi yÃªu cáº§u chÆ°a Ä‘á»§ lá»›n. Xem hÃ¬nh bÃªn dÆ°á»›i:</li>
</ul>

<h4 id="code-python-Ä‘á»ƒ-chia-thÃ nh-nhiá»u-task-phá»¥">Code Python Ä‘á»ƒ chia thÃ nh nhiá»u task phá»¥</h4>
<h5 id="sá»­-dá»¥ng-api-multiprocessingpool">Sá»­ dá»¥ng API <strong>multiprocessing.Pool</strong></h5>

<p><img src="img/pool.png" alt="" /></p>

<h5 id="sá»­-dá»¥ng-dask-framework-Ä‘á»ƒ-trÃ¡nh-viáº¿t-api-dÆ°á»›i-há»‡-thá»‘ng">Sá»­ dá»¥ng DASK framework Ä‘á»ƒ trÃ¡nh viáº¿t API dÆ°á»›i há»‡ thá»‘ng</h5>

<p><img src="img/dask.png" alt="" /></p>

<p>Má»™t sá»‘ ghi chÃº cho Parallel computing:</p>

<blockquote>
  <ul>
    <li>KhÃ´ng pháº£i lÃºc nÃ o cÅ©ng tÄƒng thá»i gian xá»­ lÃ½ cÃ´ng viá»‡c, do hiá»‡u á»©ng cá»§a overhead communication á»Ÿ pháº§n contact switch giá»¯a cÃ¡c á»©ng dá»¥ng.</li>
    <li>GIÃºp tá»‘i Æ°u viá»‡c sá»­ dá»¥ng bá»™ xá»­ lÃ½ Ä‘a nhiá»‡m (multiple processing unit)</li>
    <li>GiÃºp tá»‘i Æ°u bá»™ nhá»› giá»¯a má»™t sá»‘ há»‡ thá»‘ng</li>
  </ul>
</blockquote>

<p>BÃ i viáº¿t vá» Parallel computing Ä‘áº¿n Ä‘Ã¢y lÃ  káº¿t thÃºc, cÃ¡c báº¡n cÃ³ thá»ƒ xem qua 1 sá»‘ Ä‘oáº¡n code liÃªn quan Ä‘áº¿n chá»§ Ä‘á» nÃ y á»Ÿ repo data-engineering cá»§a mÃ¬nh nhÃ©!</p>

<hr />

<h2 id="iii-parallel-computation-framework">III. Parallel computation framework</h2>

<h3 id="1-hadoop">1. Hadoop</h3>

<p>Hadoop lÃ  táº­p há»£p cÃ¡c dá»± Ã¡n open-source Ä‘Æ°á»£c maintain bá»Ÿi Apache Software Foudation. CÃ³ 2 dá»± Ã¡n phá»• biáº¿n thÆ°á»ng Ä‘Æ°á»£c nháº¯c Ä‘áº¿n lÃ  <strong>MapReduce</strong> vÃ  <strong>HDFS</strong>.</p>

<h4 id="a-nÃ³i-vá»-hdfs">a. NÃ³i vá» HDFS</h4>
<p>ÄÃ¢y lÃ  tÃªn gá»i cá»§a há»‡ thá»‘ng phÃ¢n tÃ¡n táº­p tin (distributed file system). CÅ©ng lÃ  cÃ¡c táº­p tin trong mÃ¡y tÃ­nh nhÆ°ng Ä‘Æ°á»£c Ä‘iá»u Ä‘áº·c biá»‡t lÃ  nÃ³ Ä‘Æ°á»£c phÃ¢n tÃ¡n trÃªn nhiá»u mÃ¡y tÃ­nh khÃ¡c nhau.</p>

<p>HDFS lÃ  má»™t pháº§n thiáº¿t yáº¿u trong Big data Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u lá»›n.</p>

<p><img src="img/hdfs.png" alt="" /></p>

<h4 id="b-nÃ³i-vá»-mapreduce">b. NÃ³i vá» MapReduce</h4>
<p>ÄÃ¢y lÃ  má»™t trong cÃ¡c mÃ´ hÃ¬nh Ä‘áº§u tiÃªn phá»• biáº¿n trong viá»‡c xá»­ lÃ½ Big data.
CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a nÃ³ lÃ  chia task lá»›n thÃ nh nhiá»u task nhá» rá»“i phÃ¢n tÃ¡n khá»‘i lÆ°á»£ng dá»¯ liá»‡u vÃ  dá»¯ liá»‡u Ä‘áº¿n cÃ¡c Ä‘Æ¡n vá»‹ xá»­ lÃ½ (processing unit).
Tuy nhiÃªn, MapReduce cÃ³ má»™t sá»‘ khuyáº¿t Ä‘iá»ƒm cÃ³ thá»ƒ ká»ƒ Ä‘áº¿n nhÆ° khÃ³ viáº¿t cÃ¡c job Ä‘á»ƒ chia task vÃ  phÃ¢n tÃ¡n cháº³ng háº¡n.</p>
<blockquote>
  <p>ChÆ°Æ¡ng trÃ¬nh pháº§n má»m <strong>Hive</strong> vÃ  má»™t sÃ³ pháº§n má»m khÃ¡c ra Ä‘á»i Ä‘á»ƒ giáº£i quyáº¿t khÃ³ khÄƒn trÃªn.</p>
</blockquote>

<p>Hive nhÆ° lÃ  lá»›p vá» trÃªn cÃ¹ng trong há»‡ sinh thÃ¡i cá»§a Hadoop giÃºp cÃ¡c dá»¯ liá»‡u Ä‘áº¿n tá»« nhá»¯ng nguá»“n khÃ¡c nhau cÃ³ thá»ƒ truy váº¥n báº±ng cÃ¡ch sá»­ dá»¥ng ngÃ´n ngá»¯ truy váº¥n cÃ³ cáº¥u trÃºc Hive SQL (HQL).</p>

<p>VÃ­ dá»¥ Ä‘oáº¡n truy váº¥n Hive SQL:
<img src="img/hive-sql.png" alt="" /></p>

<blockquote>
  <p><strong>Nháº­n xÃ©t:</strong> trÃ´ng cháº£ khÃ¡c cÃ¢u lá»‡nh SQL thÃ´ng thÆ°á»ng pháº£i khÃ´ng ? ^^ Tuy nhiÃªn sau táº¥m mÃ n Ä‘Ã³ thÃ¬ má»i thá»© sáº½ khÃ¡c. CÃ¢u truy váº¥n trÃªn sáº½ chuyá»ƒn Ä‘á»•i thÃ nh job cÃ³ nhiá»‡m vá»¥ phÃ¢n tÃ¡n Ä‘áº¿n táº­p há»£p cÃ¡c mÃ¡y tÃ­nh Ä‘áº¥y (cluster).</p>
</blockquote>

<h3 id="2-spark-framework">2. Spark framework</h3>
<p>NgoÃ i Hadoop, ta cÃ²n cÃ³ Spark, cÅ©ng cÃ³ nhiá»‡m vá»¥ phÃ¢n tÃ¡n cÃ¡c task xá»­ lÃ½ dá»¯ liá»‡u giá»¯a cÃ¡c cluster, ngÃ y nay Ä‘Æ°á»£c sá»­ dá»¥ng phá»• biáº¿n hÆ¡n.</p>

<p>Trong khi há»‡ thá»‘ng Hadoop MapReduce cáº§n á»• Ä‘Ä©a Ä‘áº¯t tiá»n Ä‘á»ƒ ghi dá»¯ liá»‡u giá»¯a cÃ¡c job, thÃ¬ Spark láº¡i sá»­ dá»¥ng má»™t cÃ¡ch tá»‘i Æ°u bá»™ nhá»› xá»­ lÃ½ trÃ¡nh sá»­ dá»¥ng á»• Ä‘Ä©a Ä‘á»ƒ ghi dá»¯ liá»‡u.</p>

<p>Spark ra Ä‘á»i Ä‘Ã£ cho tháº¥y nhá»¯ng háº¡n cháº¿ cá»§a MapReduce, trong Ä‘Ã³ bao gá»“m viá»‡c MapReduce háº¡n cháº¿ tÆ°Æ¡ng tÃ¡c cá»§a ngÆ°á»i dÃ¹ng khi truy cáº­p phÃ¢n tÃ­ch dá»¯ liá»‡u vÃ  má»—i bÆ°á»›c build sáº½ pháº£i dá»±a trÃªn bÆ°á»›c trÆ°á»›c Ä‘Ã³. =&gt; khÃ´ng linh hoáº¡t, khÃ³ tÆ°Æ¡ng tÃ¡c hÆ¡n Spark.</p>

<h4 id="a-kiáº¿n-trÃºc-cá»§a-spark">a. Kiáº¿n trÃºc cá»§a Spark</h4>

<p>Dá»±a trÃªn RDDs (Resilient distributed datasets)</p>

<p>RDD lÃ  má»™t loáº¡i cáº¥u trÃºc dá»¯ liá»‡u cÃ³ nhiá»‡m vá»¥ duy trÃ¬ cÃ¡c dá»¯ liá»‡u Ä‘Æ°á»£c phÃ¢n tÃ¡n giá»¯a nhiá»u node.</p>

<p>KhÃ´ng giá»‘ng vá»›i DataFrame, RDDs khÃ´ng cÃ³ cÃ¡c cá»™t. Vá» khÃ¡i niá»‡m thÃ¬ cÃ³ thá»ƒ xem nÃ³ lÃ  má»™t dÃ£y cÃ¡c tuples, vÃ­ dá»¥ vá» tuple â€œdayâ€:</p>
<pre><code>day = ('monday', 'tuesday', 'wednesday' , 'thursday', 'friday', 'saturday' , 'sunday')
</code></pre>

<p>Vá»›i cÃ¡c dá»¯ liá»‡u cÃ³ cáº¥u trÃºc RDD ta cÃ³ thá»ƒ thá»±c thi 2 loáº¡i lá»‡nh :</p>
<ul>
  <li>Chuyá»ƒn Ä‘á»•i: dÃ¹ng method .map() hoáº·c .filter() =&gt; output ra cÃ¡c dáº¡ng dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i</li>
  <li>HÃ nh Ä‘á»™ng: dÃ¹ng method .count() hoáº·c .first() =&gt; ra 1 output duy nháº¥t (sá»‘, chá»¯, v.v)</li>
</ul>

<p>Spark framework cÃ³ nhiá»u interface á»©ng vá»›i cÃ¡c ngÃ´n ngá»¯ láº­p trÃ¬nh, phá»• biáº¿n nháº¥t lÃ  PySpark dÃ¹ng ngÃ´n ngá»¯ Python. NgoÃ i ra cÃ²n cÃ³ cÃ¡c ngÃ´n ngá»¯ khÃ¡c nhÆ° Scala, R.</p>

<blockquote>
  <p>**PySpark dÃ¹ng host dá»±a trÃªn Dataframe trá»«u tÆ°á»£ng, Ä‘Ã³ lÃ  lÃ­ do náº¿u chÃºng ta thÆ°á»ng sá»­ dá»¥ng thÆ° viá»‡n pandas cá»§a dataframe sáº½ dá»… lÃ m quen hÆ¡n vÃ¬ hoáº¡t Ä‘á»™ng cá»§a PySpark sáº½ tÆ°Æ¡ng tá»± tháº¿.</p>
</blockquote>

<blockquote>
  <blockquote>
    <p>TÃ³m láº¡i lÃ  cÃ¡c cÃ´ng viá»‡c vá» parallel computing tá»« Ä‘Æ¡n giáº£n Ä‘áº¿n phá»©c táº¡p cá»© Ä‘á»ƒ nhÃ  Spark lo :smile: cÃ²n chaá»µ nhÆ° tháº¿ nÃ o lÃ  tÃ¹y báº¡n.</p>
  </blockquote>
</blockquote>

<p>Xem vÃ­ dá»¥ vá» PySpark khi tÃ­nh trung bÃ¬nh cÃ¡c váº­n Ä‘á»™ng viÃªn theo nhÃ³m tuá»•i nhÃ©:</p>

<p><img src="img/pyspark-eg.png" alt="" /></p>
:ET