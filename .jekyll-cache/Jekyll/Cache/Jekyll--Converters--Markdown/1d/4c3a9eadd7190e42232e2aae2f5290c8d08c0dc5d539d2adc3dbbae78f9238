I"ô4<h4 id="1-import--load--táº¡o-httpget-request">1. Import + Load + Táº¡o HTTP/GET REQUEST</h4>
<ul>
  <li>LÆ°u file má»m xuá»‘ng local:
<code>urlretrieve(url, 'filename.csv')</code></li>
</ul>

<p>TrÆ°á»›c tiÃªn pháº£i <code>from urllib.request import urlretrieve</code></p>

<ul>
  <li>Má»Ÿ vÃ  Ä‘á»c file má»m trÃªn web:
<code>
df = pd.read_csv(url, sep=';')
</code></li>
  <li>
    <p>Show cÃ¡c dÃ²ng Ä‘áº§u tiÃªn cá»§a df:
<code>
print(df.head())
</code></p>
  </li>
  <li>URL (Uniform/Universal Resource Locator)
pháº§n lá»›n lÃ  cÃ¡c Ä‘á»‹a chá»‰ web, ngoÃ i ra cÃ²n lÃ  FTP (file transfer protocol)</li>
</ul>

<p>URL gá»“m 2 pháº§n:</p>

<ul>
  <li>Protocol Identifier : http hoáº·c https</li>
  <li>
    <p>TÃªn resource: datacamp.com
=&gt; táº¡o thÃ nh 1 Ä‘á»‹a chá»‰ web</p>
  </li>
  <li>
    <p>HTTP (HyperText Transfer Protocol)
LÃ  protocol á»©ng dá»¥ng cho cÃ¡c há»‡ thá»‘ng thÃ´ng tin phÃ¢n tÃ¡n, cá»™ng tÃ¡c vÃ  siÃªu phÆ°Æ¡ng tiá»‡n, ná»n táº£ng giao tiáº¿p dá»¯ liá»‡u cho WWW.
HTTPS - cÃ³ Ä‘á»™ an toÃ n báº£o máº­t cao hÆ¡n HTTP</p>
  </li>
  <li>Má»—i khi truy cáº­p vÃ o 1 trang web nghÄ©a lÃ  báº¡n Ä‘ang gá»­i 1 HTTP request cho 1 server. Request nÃ y Ä‘Æ°á»£c gá»i lÃ  GET request, Ä‘Ã¢y lÃ  loáº¡i request phá»• biáº¿n nháº¥t.</li>
</ul>

<blockquote>
  <p>urlretrieve : gá»­i GET request vÃ  lÆ°u dá»¯ liá»‡u xuá»‘ng local mÃ¡y</p>
</blockquote>

<ul>
  <li>HTML (HyperText Markup Language)</li>
</ul>

<h4 id="2-cÃ¡c-cÃ¡ch-gá»­i-get-request">2. CÃ¡c cÃ¡ch gá»­i GET request:</h4>

<ul>
  <li><strong>CÃ¡ch 1</strong>: sá»­ dá»¥ng <code>urllib.request</code>
=&gt; <code>from urllib.request import urlopen, Request</code></li>
</ul>

<p>Má»™t sá»‘ functions cá»§a package <code>urllib.request</code></p>

<ul>
  <li><code>request = Request(url)</code> : Ä‘Ã³ng gÃ³i GET request</li>
  <li><code>response = urlopen(request)</code> : 
gá»­i request vÃ  catch pháº£n há»“i =&gt; tráº£ vá» HTTP response object cÃ³ tÃ­ch há»£p method read() vÃ  close()</li>
  <li><code>html = response.read()</code> : tráº£ vá» HTML Ä‘á»‹nh dáº¡ng string</li>
  <li>
    <p><code>response.close()</code>: dÃ¹ng xong nhá»› Ä‘Ã³ng láº¡i</p>
  </li>
  <li><strong>CÃ¡ch 2</strong>: ráº¥t phá»• biáº¿n, sá»­ dá»¥ng package <code>requests</code></li>
</ul>

<p>Cho phÃ©p gá»­i HTTP request cÃ³ tá»• chá»©c mÃ  ko cáº§n lÃ m thá»§ cÃ´ng</p>

<p>requests.get(url) : sau khi import package requests, hÃ m request.get() sáº½ Ä‘Ã³ng gÃ³i request thÃ´ng qua url, gá»­i request Ä‘i vÃ  nháº­n láº¡i pháº£n há»“i vÃ  lÆ°u vÃ o biáº¿n r.</p>
<blockquote>
  <p>á» Ä‘Ã¢y hÃ m <code>request.get()</code> sáº½ lÃ m nhiá»‡m vá»¥ cá»§a <code>Request(url)</code> vÃ  <code>urlopen(request Ä‘Ã£ Ä‘Ã³ng gÃ³i)</code>cá»§a cÃ¡ch 1</p>
</blockquote>

<p>r.text : r lÃ  biáº¿n lÆ°u response cá»§a hÃ m trÃªn, sá»­ dá»¥ng method .text cho response Ä‘á»ƒ chuyá»ƒn HTML cá»§a url sang dáº¡ng string.</p>

<h4 id="3-scraping-web-trong-python">3. Scraping web trong Python</h4>

<p>HTML lÃ  sá»± káº¿t há»£p cá»§a data cÃ³ cáº¥u trÃºc vÃ  khÃ´ng cáº¥u trÃºc.</p>

<ul>
  <li>HÃ m <code>BeautifulSoup()</code> cÃ³ tÃ¡c dá»¥ng parse vÃ  trÃ­ch xuáº¥t data tá»« HTML, vÃ  lÃ m cho cÃ¡c tag Ä‘Æ°á»£c biá»ƒu diá»…n Ä‘áº¹p hÆ¡n.</li>
</ul>

<p>CÃ¡ch sá»­ dá»¥ng: 
<code>from bs4 import BeautifulSoup</code></p>

<p>Sau khi gá»­i nháº­n pháº£n há»“i cá»§a GET request, ta Ä‘Æ°á»£c file html nhÆ° trÃªn.</p>

<p>Sau Ä‘Ã³, ta dÃ¹ng hÃ m <code>BeautifulSoup</code> Ä‘á»ƒ extract cÃ¡c data cÃ³ cáº¥u trÃºc cá»§a file html, lÆ°u káº¿t quáº£ lÃ  má»™t object vÃ o má»™t biáº¿n má»›i. Káº¿t quáº£ cá»§a hÃ m <code>BeautifulSoup</code>cÃ³ tÃ­ch há»£p hÃ m <code>.prettify()</code> Ä‘á»ƒ lÃ m Ä‘áº¹p káº¿t quáº£.</p>

<p><code>soup = BeautifulSoup(html_doc)
print(soup.prettify())</code></p>

<ul>
  <li>
    <p>CÃ¡c hÃ m khÃ¡c cÃ³ thá»ƒ dÃ¹ng sau khi parse vÃ  nháº­n káº¿t quáº£ tá»« BeautifulSoup:</p>

    <ul>
      <li><code>soup.title()</code> : trÃ­ch title cá»§a file html</li>
      <li><code>soup.get_text()</code>: trÃ­ch táº¥t cáº£ text cá»§a file html</li>
      <li><code>soup.find_all()</code> : tÃ¬m táº¥t cáº£ cÃ¡c data theo Ä‘iá»u kiá»‡n hoáº·c tag nÃ o Ä‘Ã³.
  VÃ­ dá»¥:
        <pre><code>  for link in soup.find_all('a'):
  print(link.get('href')
</code></pre>
        <p>hoáº·c</p>
        <pre><code>  for link in a_tags:
  print(link.get('href'))
</code></pre>
      </li>
    </ul>
  </li>
</ul>

<p>=&gt; á» Ä‘Ã¢y, ta sá»­ dá»¥ng vÃ²ng láº·p for káº¿t há»£p hÃ m <code>.find_all()</code> extract data náº±m trong tag <code>&lt;a&gt;</code> cá»§a file html vÃ  in ra tá»«ng link cá»§a má»—i dÃ²ng tÃ¬m Ä‘Æ°á»£c, ta cÅ©ng cÃ³ thá»ƒ lÆ°u <code>soup.find_all()</code> vÃ o má»™t biáº¿n nÃ o Ä‘Ã³.
HÃ m <code>link.get('href')</code> dÃ¹ng Ä‘á»ƒ extract giÃ¡ trá»‹ link cá»§a attribute href trong tag <code>&lt;a&gt;</code></p>

<h4 id="4-load-vÃ -khÃ¡m-phÃ¡-file-json">4. Load vÃ  khÃ¡m phÃ¡ file JSON</h4>
<h6 id="file-json-náº±m-á»Ÿ-local">FIle JSON náº±m á»Ÿ local</h6>

<ul>
  <li>BÆ°á»›c 1: Táº¡o connection vá»›i file JSON trong local vÃ  load file
    <pre><code>with open("tÃªn file.json") as json_file :
  json_data = json.load(json_file)
</code></pre>
    <p>á» Ä‘Ã¢y json_data lÃ  1 object dictionary, ta check báº±ng <code>type(json_data)</code> ra káº¿t quáº£ <code>dict</code></p>
  </li>
  <li>BÆ°á»›c 2: Sá»­ dá»¥ng vÃ²ng láº·p <code>for</code> Ä‘á»ƒ in cáº·p key-value ra
    <pre><code>for k in json_data.keys():
  print(k + ': ', json_data[k])
</code></pre>
    <p>Tá»« object dictionary trÃªn, ta dÃ¹ng Ã m <code>.keys</code> Ä‘á»ƒ truy cáº­p vÃ o keys cá»§a file vÃ  dÃ¹ng cÃº phÃ¡p <code>dictionary[key]</code> Ä‘á»ƒ truy cáº­p vÃ o value.</p>
  </li>
</ul>

<h4 id="5-apis-vÃ -tÆ°Æ¡ng-tÃ¡c-cÆ¡-báº£n">5. APIs vÃ  tÆ°Æ¡ng tÃ¡c cÆ¡ báº£n</h4>

<h5 id="api-lÃ -gÃ¬">API lÃ  gÃ¬?</h5>
<ul>
  <li>LÃ  má»™t bá»™ protocols vÃ  routines Ä‘á»ƒ xÃ¢y dá»±ng vÃ  tÆ°Æ¡ng tÃ¡c vá»›i pháº§n má»m</li>
  <li>Má»™t táº­p há»£p code cho phÃ©p 02 chÆ°Æ¡ng trÃ¬nh pháº§n má»m giao tiáº¿p vá»›i nhau
VÃ­ dá»¥ náº¿u muá»‘n stream data cá»§a Twitter thÃ¬ ta cÃ¹ng API cá»§a Twitter.</li>
  <li>ThÃ´ng thÆ°á»ng data thÆ°á»ng Ä‘Æ°á»£c láº¥y vá» tá»« APIs á»Ÿ Ä‘á»‹nh dáº¡ng JSON.</li>
</ul>

<h5 id="url-cÃ³-gÃ¬-vÃ -lÃ m-thá»ƒ-nÃ o-Ä‘á»ƒ-nÃ³-biáº¿t-pull-data-tá»«-api-vá»">URL cÃ³ gÃ¬ vÃ  lÃ m thá»ƒ nÃ o Ä‘á»ƒ nÃ³ biáº¿t pull data tá»« API vá»?</h5>

<p><code>url = 'http://www.omdbapi.com/?t=hackers'</code></p>

<ul>
  <li>http - dáº¥u hiá»‡u lÃ  ta Ä‘ang táº¡o 1 HTTP request</li>
  <li>www.omdbapi.com - nghÄ©a lÃ  ta Ä‘ang query OMDB API</li>
  <li><code>?t=hackers</code>
    <ul>
      <li>ÄÃ¢y gá»i lÃ  Query String</li>
      <li>KhÃ´ng cÃ³ quy Æ°á»›c vÃ  khÃ´ng buá»™c cÃ³ trong Ä‘Æ°á»ng dáº«n</li>
      <li>Sau dáº¥u <code>?</code> lÃ  pháº§n query. Theo document trÃªn trang chá»§ OMDB API thÃ¬ cÃ³ nghÄ© lÃ  ta Ä‘ang muá»‘n tráº£ vá» data cá»§a bá»™ phim cÃ³ title (t) â€˜Hackersâ€™. Cá»¥ thá»ƒ xem pháº§n Usage + Parameters.</li>
    </ul>
  </li>
</ul>

<pre><code># Import package
import requests

# Assign URL to variable: url
url = 'https://en.wikipedia.org/w/api.php?action=query&amp;prop=extracts&amp;format=json&amp;exintro=&amp;titles=pizza'

# Package the request, send the request and catch the response: r
r = requests.get(url)

# Decode the JSON data into a dictionary: json_data
json_data = r.json()

print(json_data)

# Print the Wikipedia page extract
pizza_extract = json_data['query']['pages']['24768']['extract']
print(pizza_extract)
</code></pre>

<p>á» 2 dÃ²ng code cuá»‘i, Ä‘á»ƒ biáº¿t táº¡i sao code nhÆ° tháº¿, ta truy cáº­p url trÃªn browser, nÃ³ sáº½ hiá»‡n ra cÃ¡c tab. Ta muá»‘n extract data tá»« api cá»§a url thÃ¬ ta má»Ÿ tá»« tab <code>query &gt; pages &gt; 24768 &gt; extract</code> thÃ¬ sáº½ nháº­n Ä‘Æ°á»£c data tá»« api Ä‘Ã³.</p>

<h5 id="load-vÃ -khÃ¡m-phÃ¡-twitter-data">Load vÃ  khÃ¡m phÃ¡ Twitter data</h5>
<pre><code># Import package
import json

# String of path to file: tweets_data_path
tweets_data_path = 'tweets.txt'

# Initialize empty list to store tweets: tweets_data
tweets_data = []

# Open connection to file
tweets_file = open(tweets_data_path, "r")

# Read in tweets and store in list: tweets_data
for line in tweets_file:
    tweet = json.loads(line)
    tweets_data.append(tweet)

# Close connection to file
tweets_file.close()

# Print the keys of the first tweet dict
print(tweets_data[0].keys())
</code></pre>

<ul>
  <li>Äáº§u tiÃªn ta gÃ¡n Ä‘Æ°á»ng dáº«n tÃªn file chá»©a Twitter data á»Ÿ local mÃ¡y vÃ o 1 biáº¿n.</li>
  <li>Tiáº¿p theo ta táº¡o 1 máº£ng rá»—ng Ä‘á»ƒ chá»©a má»—i dÃ²ng tweet lÃ  1 pháº§n tá»­ trong máº£ng.</li>
  <li>Sau Ä‘Ã³ ta má»Ÿ connection Ä‘áº¿n file local Ä‘Ã³ thÃ´ng qua dÆ°á»ng dáº«n <code>tweets_data_path</code> vÃ  lÆ°u vÃ o <code>tweets_file</code>.</li>
  <li>Tiáº¿p theo ta dÃ¹ng vÃ²ng láº·p for Ä‘á»ƒ Ä‘á»c tá»«ng dÃ²ng cá»§a <code>tweets_file</code>:
    <ul>
      <li>DÃ¹ng hÃ m <code>json.load(line)</code> Ä‘á»ƒ load tá»«ng dÃ²ng lÆ°u vÃ o biáº¿n <code>tweet</code>, <em>Ä‘á»ƒ dÃ¹ng hÃ m trÃªn pháº£i import <code>json</code> package</em>
        <blockquote>
          <p>Note: má»—i láº§n load <code>line</code> Ä‘á»ƒ lÆ°u vÃ o <code>tweet</code> lÃ  má»™t dictionary.</p>
        </blockquote>
      </li>
      <li>Sá»­ dá»¥ng biáº¿n máº£ng <code>tweets_data</code> káº¿t há»£p hÃ m <code>append(tweet)</code> Ä‘á»ƒ add thÃªm pháº§n tá»­ dictionary má»›i (hay cÃ²n gá»i lÃ  tweet) vÃ o máº£ng.</li>
      <li>In ra táº¥t cáº£ cÃ¡c <code>keys</code> cá»§a pháº§n tá»­ Ä‘áº§u tiÃªn (tweet hay dict) cá»§a máº£ng.</li>
    </ul>
  </li>
</ul>

<h5 id="Ä‘Æ°a-máº£ng-vÃ o-dataframe-sá»­-dá»¥ng-package-pandas-Ä‘á»ƒ-phÃ¢n-tÃ­ch">ÄÆ°a máº£ng vÃ o Dataframe sá»­ dá»¥ng package pandas Ä‘á»ƒ phÃ¢n tÃ­ch</h5>

<pre><code># Import package
import pandas as pd

# Build DataFrame of tweet texts and languages
df = pd.DataFrame(tweets_data, columns=['text','lang'])
 
# Print head of DataFrame

print(df.head())
</code></pre>
<ul>
  <li>HÃ m <code>pd.Dataframe()</code> cáº§n 2 tham sá»‘ lÃ  data vÃ  column Ä‘á»ƒ xÃ¢y dá»±ng df
    <ul>
      <li>Tham sá»‘ Ä‘áº§u cÃ³ thá»ƒ lÃ  máº£ng, dict hoáº·c dataframe</li>
      <li>Tham sá»‘ thá»© 2 lÃ  column label, náº¿u khÃ´ng cÃ³ label thÃ¬ dÃ¹ng RangeIndex(0,1,2,â€¦n). Náº¿u cÃ³ label trong data nhÆ° vÃ­ dá»¥ trÃªn, ta chá»‰ cáº§n <code>columns=['text','lang']</code> Ä‘á»ƒ chá»n label cho column muá»‘n rÃºt giÃ¡ trá»‹. á» vÃ­ dá»¥ trÃªn ta sáº½ táº¡o 2 cá»™t <code>text</code> vÃ  <code>lang</code>.</li>
    </ul>
  </li>
</ul>

<h5 id="streaming">Streaming</h5>
<pre><code># Initialize Stream listener
l = MyStreamListener()

# Create your Stream object with authentication
stream = tweepy.Stream(auth, l)

# Filter Twitter Streams to capture data by the keywords:
stream.filter(track=['clinton', 'trump', 'sanders', 'cruz'])
</code></pre>

<ul>
  <li>
    <p>Class <code>MyStreamListener()</code> Ä‘Æ°á»£c khai bÃ¡o sáºµn táº¡i Ä‘Ã¢y: https://gist.github.com/hugobowne/18f1c0c0709ed1a52dc5bcd462ac69f4</p>
  </li>
  <li>
    <p>Ta táº¡o object <code>stream</code>báº±ng cÃ¡ch Ä‘Æ°a vÃ o hÃ m <code>tweepy.Stream()</code> athentication handler <code>auth</code> vÃ  object <code>l</code> - stream listener trÃªn.</p>
  </li>
  <li>
    <p>Object <code>stream</code> cÃ³ tÃ­ch há»£p hÃ m <code>.filter()</code>, trong hÃ m nÃ y cÃ³ attribute <code>track=[]</code> lÃ  list chá»©a cÃ¡c keyword mÃ  ban muá»‘n filter.</p>
  </li>
</ul>

<h5 id="phÃ¢n-tÃ­ch-data-cÆ¡-báº£n">PhÃ¢n tÃ­ch data cÆ¡ báº£n</h5>
<pre><code>import re

def word_in_text(word, text):
    word = word.lower()
    text = text.lower()
    match = re.search(word, text)

    if match:
        return True
    return False
</code></pre>

<ul>
  <li>á» trÃªn ta cÃ³ hÃ m <code>word_in_text()</code> Ä‘á»ƒ Ä‘áº¿m sá»‘ lÆ°á»£ng tweet chá»©a keyword. NhÆ°ng á»Ÿ Ä‘Ã¢y chÃºng ta chÆ°a Ä‘áº¿m, mÃ  chá»‰ Ä‘Æ°a káº¿t quáº£ náº¿u True sáº½ +1 vÃ o biáº¿n Ä‘áº¿m á»Ÿ bÆ°á»›c tiáº¿p theo.</li>
</ul>

<pre><code># Initialize list to store tweet counts
[clinton, trump, sanders, cruz] = [0, 0, 0, 0]

# Iterate through df, counting the number of tweets in which
# each candidate is mentioned
for index, row in df.iterrows():
    clinton += word_in_text('clinton', row['text'])
    trump += word_in_text('trump', row['text'])
    sanders += word_in_text('sanders', row['text'])
    cruz += word_in_text('cruz', row['text'])
</code></pre>

<ul>
  <li>Tiáº¿p theo ta sáº½ táº¡o list trong Python, má»—i item sáº½ cÃ³ giÃ¡ trá»‹ Ä‘áº¿m báº¯t Ä‘áº§u =0. Má»¥c Ä‘Ã­ch á»Ÿ Ä‘Ã¢y lÃ  Ä‘á»ƒ Ä‘áº¿m sá»‘ tweet count Ä‘Æ°á»£c cho má»—i keyword.</li>
  <li>Sá»­ dá»¥ng vÃ²ng láº·p Ä‘á»ƒ Ä‘i tá»«ng row vÃ  check, náº¿u gáº·p keyword sáº½ +1 vÃ o biáº¿n Ä‘áº¿m. Náº¿u True (nghÄ©a lÃ  cÃ³ keyword Ä‘Ã³) thÃ¬ += 1.</li>
</ul>

<h5 id="basic-data-visualization">Basic Data visualization</h5>

<pre><code># Import packages
import seaborn as sns
import matplotlib.pyplot as plt


# Set seaborn style
sns.set(color_codes=True)

# Create a list of labels:cd
cd = ['clinton', 'trump', 'sanders', 'cruz']

# Plot the bar chart
ax = sns.barplot(cd, [clinton, trump, sanders, cruz])
ax.set(ylabel="count")
plt.show()
</code></pre>

<ul>
  <li>Äáº§u tiÃªn cáº§n import 2 package nhÆ° trÃªn Ä‘á»ƒ váº½ biá»ƒu Ä‘á»“</li>
  <li>HÃ m <code>sns.barplot()</code> cÃ³ 2 tham sá»‘:
    <ul>
      <li>Tham sá»‘ Ä‘áº§u: list label cáº§n biá»ƒu diá»…n giÃ¡ trá»‹</li>
      <li>Tham sá»‘ thá»© 2: list chá»©a giÃ¡ trá»‹ cá»§a cÃ¡c label cáº§n biá»ƒu diá»…n. List nÃ y Ä‘Ã£ Ä‘Æ°á»£c khá»Ÿi táº¡o vÃ  Ä‘áº¿m á»Ÿ code trÆ°á»›c Ä‘Ã³.</li>
    </ul>
  </li>
</ul>

:ET