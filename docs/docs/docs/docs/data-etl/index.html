<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="https://tuyen-nnt.github.io/assets/images/logo.png">

<title>Extract - Transform - Load (ETL process) | Tuyen Nguyen</title>

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Extract - Transform - Load (ETL process) | My Blog</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Extract - Transform - Load (ETL process)" />
<meta name="author" content="tuyennnt" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Tìm hiểu về ETL" />
<meta property="og:description" content="Tìm hiểu về ETL" />
<meta property="og:site_name" content="My Blog" />
<meta property="og:image" content="/https://tuyen-nnt.github.io/img/etl.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-29T00:00:00+07:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="/https://tuyen-nnt.github.io/img/etl.png" />
<meta property="twitter:title" content="Extract - Transform - Load (ETL process)" />
<script type="application/ld+json">
{"@type":"BlogPosting","author":{"@type":"Person","name":"tuyennnt"},"mainEntityOfPage":{"@type":"WebPage","@id":"/https://tuyen-nnt.github.io/data-etl/"},"image":"/https://tuyen-nnt.github.io/img/etl.png","headline":"Extract - Transform - Load (ETL process)","dateModified":"2021-05-29T00:00:00+07:00","datePublished":"2021-05-29T00:00:00+07:00","url":"/https://tuyen-nnt.github.io/data-etl/","description":"Tìm hiểu về ETL","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/https://tuyen-nnt.github.io/assets/images/ava.png"},"name":"tuyennnt"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    
<link href="https://tuyen-nnt.github.io/assets/css/prism.css" rel="stylesheet">

<link href="https://tuyen-nnt.github.io/assets/css/theme.css" rel="stylesheet">

<script src="https://tuyen-nnt.github.io/assets/js/jquery.min.js"></script>

</head>




<body>
	<!-- defer loading of font and font awesome -->
	<noscript id="deferred-styles">
		<link href="https://fonts.googleapis.com/css?family=Sen:400,700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	</noscript>

<!-- Begin Sidebar Navigation
================================================== -->

<div class="sidebar">    
</div>   
<div class="nav-icon">
    <div class="hamburger-bar"></div>
</div>
<div id="blackover-nav" class="blackover"></div>
<nav id="menu">
    <ul>
        <h3>Navigation</h3>
        <li><a href="https://tuyen-nnt.github.io/">Home</a></li>
        <li><a href="https://tuyen-nnt.github.io/about">About</a></li>
        <li><a href="https://tuyen-nnt.github.io/authors">Contributors <span class="badge badge-primary">new</span></a></li>
        <li><a target="_blank" href="https://bootstrapstarter.com/jekyll-theme-memoirs/">Get Memoirs</a></li>      
        <li><a href="https://tuyen-nnt.github.io/contact">Contact</a></li>       
    </ul>   
</nav>

<script src="https://tuyen-nnt.github.io/assets/js/lunr.js"></script>

<style>
    
</style>

<div class="wrap-search">
    <div class="d-flex align-items-center ml-auto">
        <i class="fas fa-search show-search"></i>
        <form class="bd-search ml-3" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
            <input type="text" class="form-control bigradius text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
        </form>
    </div>
</div>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="https://tuyen-nnt.github.io/assets/js/lunrsearchengine.js"></script>


<!-- End Sidebar Navigation
================================================== -->

<div class="site-content ">

<div class="container">

    <!-- Site Logo/Name
    ================================================== -->
   
    <a class="navbar-brand" href="https://tuyen-nnt.github.io/">
        <img src="https://tuyen-nnt.github.io/assets/images/ava.png" alt="Tuyen Nguyen">
    </a>  
   

    <!-- Site Tag
    ================================================== -->
    

    <!-- Content
    ================================================== -->
    <div class="main-content">
        <div class="entry-header">
    <!-- Post Title -->
    <h1 class="posttitle">Extract - Transform - Load (ETL process)</h1>
    <!-- Author & Date  Box -->
    
    
    <div class="d-flex align-items-center mt-4">
        <div>
            
            <img class="author-thumb" src="https://tuyen-nnt.github.io/assets/images/ava.png" alt="Tuyen">
            
        </div>            
        <div>
        Written by Tuyen on 
        <span class="post-date"><time class="post-date" datetime="2021-05-29">29 May 2021</time></span>           
        
        </div>            
    </div>
    
</div>

<!-- Adsense under title if enabled from _config.yml (change your pub id and slot) -->


<!-- Featured Image -->

<div class="entry-featured-image">
    
    <img class="featured-image " src="https://tuyen-nnt.github.io/img/etl.png" alt="Extract - Transform - Load (ETL process)">
    
</div>


<!-- Content -->
<!-- Post, Page Content
================================================== -->
<div class="article-post">
    <!-- Toc if any -->
    
    <!-- End Toc -->
    <h1 id="tìm-hiểu-về-etl">Tìm hiểu về ETL</h1>

<h2 id="i-extract-data">I. EXTRACT DATA</h2>

<h3 id="1-các-cách-để-trích-xuất-dữ-liệu">1. Các cách để trích xuất dữ liệu</h3>
<p>Có 3 cách:</p>

<p><img src="img/extract.png" alt="" /></p>

<ul>
  <li>
    <p>Trích xuất từ file text, như file .txt or .csv
Text file có 3 loại là : 
	* Text thuần
	* Flat file (là file có .tsv hoặc .csv cách nhau bởi dấu “,” hoặc “tab” giữa các giá trị). Những file này có dòng thể hiện các record và cột thể hiện attribute của record.
	*File JSON: bán cấu trúc, có 4 kiểu dữ liệu atomic là number, string, boolean và null và 2 kiểu dữ liệu dạng composite là array và object.
	JSON có package hỗ trợ là “json” để import data
	<img src="img/load-json.png" alt="" /></p>
  </li>
  <li>
    <p>Trích xuất từ web hoặc APIs của web services, như là Hacker News API
<img src="img/web-extract.png" alt="" /></p>
    <ul>
      <li>Thông qua web:</li>
    </ul>

    <p><img src="img/data-web.png" alt="" /></p>
  </li>
</ul>

<p>Ví dụ: bạn tìm kiếm thông tin trên google.com thì trình duyệt của bạn sẽ gửi request của bạn đến server của google và google sẽ trả về dữ liệu mà bạn đang tìm kiếm.</p>

<pre><code>* Thông qua API của web:
</code></pre>

<p>Không phải lúc nào các trang web cũng trả về kết quả mà người thường có thể đọc ngay, mà các trang web đó sẽ trả về định dạng JSON thông qua API mà chúng ta request.</p>

<p>Ta xem ví dụ request API từ trang Hackernews:
<img src="img/api-request.png" alt="" />
Ta import package “request” rồi dùng method .get() để chèn vào link web cần lấy file JSON. 
Sau đó ta dùng method .json() để phân tích file JSON từ kết quả đã lấy được và chuyển hóa nó thành Python object.</p>

<ul>
  <li>Trích xuất từ một database trên web services 
Hầu hết các ứng dụng web đều có database để backup và để không bị ảnh hưởng khi tắt server, v.v. Cần phân biệt 2 loại database chính trong trường hợp này:
    <ul>
      <li><em>Application database</em> : dùng cho trường hợp có nhiều giao dịch được cập nhật, loại này còn có tên gọi là <em>OLTP</em> (online transaction processing)</li>
      <li><em>Analytical database</em>: được xây dựng cho việc phân tích dữ liệu còn gọi là <em>OLAP</em> (online analytical processing)</li>
    </ul>
  </li>
</ul>

<h3 id="2-trích-xuất-dữ-liệu-từ-database-như-thế-nào">2. Trích xuất dữ liệu từ database như thế nào?</h3>

<ul>
  <li>Dùng URI/chuỗi connection, cú pháp như sau:
    <pre><code>[database_type]://[user[:password]@][host][:port]
</code></pre>
  </li>
  <li>Trong Python, ta dùng connection URI thông qua package <code>sqlalchemy</code> để tạo <em>database engine</em> :</li>
</ul>

<p><img src="img/create-engine.png" alt="" /></p>

<p>Từ engine đã được tạo ra, ta có thể dùng nó để đặt vào 1 số package hỗ trợ nó tương tác với database, đặc biệt là package <code>pandas</code>.</p>

<ul>
  <li>import requests
```</li>
</ul>

<h1 id="lấy-dữ-liệu-từ-bài-viết-của-hackernews-về-f12-inspect-để-lấy-url-của-nó">Lấy dữ liệu từ bài viết của Hackernews về, F12 inspect để lấy URL của nó</h1>
<p>resp = requests.get(“https://hacker-news.firebaseio.com/v0/item/16222426.json”)</p>

<h1 id="in-dữ-liệu-vừa-parse-thành-file-json-ra-màn-hình">in dữ liệu vừa parse thành file json ra màn hình</h1>
<p>print(resp.json())</p>

<h1 id="parse-dữ-liệu-ra-rồi-gán-value-của-key-score-vào-biến-post_score-sau-đó-in-cái-biến-ra">parse dữ liệu ra rồi gán value của key “score” vào biến post_score, sau đó in cái biến ra</h1>
<p>post_score = resp.json()[“score”]
print(post_score)</p>
<pre><code>

* Một số ví dụ mở rộng hơn (xem phần 3 để hiểu hơn):

Đọc dữ liệu từ database của postgreSQL, hàm extract dùng SQL query có nhiệm vụ chuyển từ dữ liệu bảng thành kiểu object mà pandas dùng (là dataframe)

</code></pre>
<h1 id="function-to-extract-table-to-a-pandas-dataframe">Function to extract table to a pandas DataFrame</h1>
<p>def extract_table_to_pandas(tablename, db_engine):
    query = “SELECT * FROM {}”.format(tablename)
    return pd.read_sql(query, db_engine)</p>

<h1 id="connect-to-the-database-using-the-connection-uri-sử-dụng-package-sqlalchemy">Connect to the database using the connection URI, sử dụng package sqlalchemy</h1>
<p>connection_uri = “postgresql://repl:password@localhost:5432/pagila” 
db_engine = sqlalchemy.create_engine(connection_uri)</p>

<h1 id="extract-the-film-table-into-a-pandas-dataframe-lưu-ý-nhớ-để-tên-bảng-dạng-chuỗi">Extract the film table into a pandas DataFrame, lưu ý nhớ để tên bảng dạng chuỗi</h1>
<p>extract_table_to_pandas(“film”, db_engine)</p>

<h1 id="extract-the-customer-table-into-a-pandas-dataframe">Extract the customer table into a pandas DataFrame</h1>
<p>extract_table_to_pandas(“customer”, db_engine)
```</p>

<h2 id="2-transform-data">2. TRANSFORM DATA</h2>
<h3 id="1-một-số-phương-thức-chuyển-đổi-dữ-liệu">1. Một số phương thức chuyển đổi dữ liệu</h3>
<p>Có thể thực hiện 1 hoặc nhiều các hình thức trong giai đoạn chuyển đổi dữ liệu đã rút trích:</p>

<ul>
  <li>Select 1 hay nhiều cột</li>
  <li>Phiên dịch dữ liệu thành code. Ví dụ như New York sẽ biến thành NY</li>
  <li>Kiểm tra dữ liệu có đúng không, nếu dữ liệu không đúng với kiểu dữ liệu hoặc dữ liệu muốn nhận từ cột, ta có thể bỏ record đó đi. Ví dụ như cột ngày nhưng lại chứa giá trị khác ngày.</li>
  <li>Tách dữ liệu của 1 cột thành nhiều cột</li>
  <li>Join dữ liệu từ các nguồn, các bảng khác nhau.</li>
</ul>

<h3 id="2-một-số-ví-dụ">2. Một số ví dụ</h3>

<p>Bạn có thể dùng package <code>pandas</code> để chuyển đổi dữ liệu nếu lượng dữ liệu nhỏ. Ta có ví dụ tách dữ liệu từ 1 cột thành 2 cột sử dụng pandas:
<img src="img/split-pandas.png" alt="" /></p>

<p>Nếu dữ liệu lớn, thông thường người ta sẽ dùng <strong>PySpark</strong>. Ta có ví dụ chuyển đổi dữ liệu bằng cách join các bảng với nhau. 
Nhưng trước hết chúng ta cần đẩy dữ liệu lên Spark:</p>

<p><img src="img/extract-pyspark.png" alt="" /></p>

<p><code>jbdc:</code>để nhắn nhủ với Spark là phải dùng JBDC để kết nối, sau đó, ta input vào tên của bảng và cuối cùng trong <code>properties</code> chúng ta đặt thông tin kết nối vào.</p>

<p>Dưới đây là 2 bảng cần join với nhau thông qua <code>customer_id</code> để tính rating trung bình của mỗi customer dành cho các phim:</p>

<p><img src="img/rating-join.png" alt="" /></p>

<p>Và làm sao để dùng PySpark join và tính toán dữ liệu? Xem ảnh dưới nhé:</p>

<p><img src="img/join-pyspark.png" alt="" /></p>

<p>Mình sẽ cho ra thêm các bài viết tìm hiểu sâu hơn về PySpark trong thời gian tới, các bạn hãy cùng chờ đợi nhé!</p>

<h2 id="iii-load-data">III. LOAD DATA</h2>


</div>

<!-- Rating -->


<!-- Author Box if enabled from _config.yml -->
<!-- Author Box -->


<div class="authorbox mb-5 mt-5 pt-4 pb-4">   
    <div class="row">
        <div class="wrapavname col-md-3 text-center">
            
            <img  class="author-thumb" src="https://tuyen-nnt.github.io/assets/images/ava.png" alt="Tuyen">
            
            <p class="mt-4 mb-0 small text-center">
                <a target="_blank" class="d-inline-block mx-1 text-dark" href="https://www.tuyen-nnt.github.io"><i class="fa fa-link"></i></a> 
                <a target="_blank" class="d-inline-block mx-1 text-dark" href=""><i class="fab fa-twitter"></i></a>
                <a class="d-inline-block mx-1 text-dark" href="mailto:tuyendev96@gmail.com"><i class="fa fa-envelope"></i></a>
            </p>
        </div>
        <div class="col-md-9">
            <h4>Tuyen</h4>
            <p class="mt-3 mb-0">Author of this blog, mostly about Technical which is the field I am interested in.</p>
        </div>
    </div> 
</div> 



<!-- Comments if not disabled with comments: false -->
<!-- Comments
================================================== -->
 
<div class="comments mt-5">
    <button class="btn btn-outline-dark py-2 px-5 d-block w-100 show-comments"><i class="fa fa-comments text-muted"></i> &nbsp; Load Comments</button>         
    <div id="comments">  
        <h4 class="mb-4">Comments</h4>                 
            <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'demowebsite'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
     
    <div class="clearfix"></div>              
    </div>    
</div>       


<!-- Share -->
<div class="share">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Extract - Transform - Load (ETL process)&url=/https://tuyen-nnt.github.io/data-etl/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=/https://tuyen-nnt.github.io/data-etl/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=/https://tuyen-nnt.github.io/data-etl/" onclick="window.open(this.href, 'width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
</div>


<!-- Related Post -->
<!-- Related Posts
================================================== -->
<div class=" related-posts ">  

    
    <h2 class="text-center mb-4">Explore more like this</h2>
    
    
    <div class="d-flex justify-content-center align-items-center">
    
    <!-- Categories -->
    
    
    <a class="smoothscroll badge badge-primary text-capitalize" href="https://tuyen-nnt.github.io/categories#Data">Data</a>                
    

    <!-- Tags -->  
    
    

    </div>

    
    
    
    <div class="blog-grid-container">
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
        
        
        
            
            
        
            
        
            
            <!-- begin post -->


<div class="blog-grid-item">
    <div class="card h-100">
        <div class="maxthumb">
            <a href="https://tuyen-nnt.github.io/python-intermediate/">
                

                    
                        <img class="img-thumb" src="https://tuyen-nnt.github.io/img/python1.png" alt="Python - Part 2"> 
                    

                
            </a>
        </div>
        <div class="card-body">
            <h2 class="card-title">
                <a class="text-dark" href="https://tuyen-nnt.github.io/python-intermediate/">Python - Part 2</a>
                
            </h2>
            <h4 class="card-text">1. Dictionaries Là tập hợp các cặp key:value khi cần kết nối dữ liệu với nhau như 1 table để tra cứu nhanh và có thể chỉ ra unique keys...</h4>
        </div>
        <div class="card-footer bg-white">
            <div class="wrapfooter">
                
                <span class="meta-footer-thumb">
                
                <img class="author-thumb" src="https://tuyen-nnt.github.io/assets/images/ava.png" alt="Tuyen">
                
                </span>
                <span class="author-meta">
                <span class="post-name font-weight-bold">Tuyen</span> 
                
                <span class="post-date">02 Aug 2021</span>
                </span>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
</div>
<!-- end post -->
            
            
            
        
        
        
            
            
        
            
        
            
            <!-- begin post -->


<div class="blog-grid-item">
    <div class="card h-100">
        <div class="maxthumb">
            <a href="https://tuyen-nnt.github.io/import-data-medium/">
                

                    
                        <img class="img-thumb" src="https://tuyen-nnt.github.io/img/import1.png" alt="Import Data - Part 2"> 
                    

                
            </a>
        </div>
        <div class="card-body">
            <h2 class="card-title">
                <a class="text-dark" href="https://tuyen-nnt.github.io/import-data-medium/">Import Data - Part 2</a>
                
            </h2>
            <h4 class="card-text">1. Import + Load + Tạo HTTP/GET REQUEST

  Lưu file mềm xuống local:
urlretrieve(url, 'filename.csv')


</h4>
        </div>
        <div class="card-footer bg-white">
            <div class="wrapfooter">
                
                <span class="meta-footer-thumb">
                
                <img class="author-thumb" src="https://tuyen-nnt.github.io/assets/images/ava.png" alt="Tuyen">
                
                </span>
                <span class="author-meta">
                <span class="post-name font-weight-bold">Tuyen</span> 
                
                <span class="post-date">18 Jul 2021</span>
                </span>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
</div>
<!-- end post -->
            
            
            
        
        
        
            
            
        
            
        
            
            <!-- begin post -->


<div class="blog-grid-item">
    <div class="card h-100">
        <div class="maxthumb">
            <a href="https://tuyen-nnt.github.io/python-basic/">
                

                    
                        <img class="img-thumb" src="https://tuyen-nnt.github.io/img/python1.png" alt="Python - Part 1"> 
                    

                
            </a>
        </div>
        <div class="card-body">
            <h2 class="card-title">
                <a class="text-dark" href="https://tuyen-nnt.github.io/python-basic/">Python - Part 1</a>
                
            </h2>
            <h4 class="card-text">I. LIST

</h4>
        </div>
        <div class="card-footer bg-white">
            <div class="wrapfooter">
                
                <span class="meta-footer-thumb">
                
                <img class="author-thumb" src="https://tuyen-nnt.github.io/assets/images/ava.png" alt="Tuyen">
                
                </span>
                <span class="author-meta">
                <span class="post-name font-weight-bold">Tuyen</span> 
                
                <span class="post-date">11 Jul 2021</span>
                </span>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>
</div>
<!-- end post -->
            
            
                
        </div>        
</div>

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

    </div>

    
    <!-- Newsletter
    ================================================== -->
    <div class="newsletter text-center">
        <span class="h4"><img src="https://tuyen-nnt.github.io/assets/images/ava.png" class="newsletter-logo" alt="My Blog"> &nbsp; Never miss a <b>story</b> from us, subscribe to our newsletter</span>
        <form action="https://wowthemes.us11.list-manage.com/subscribe/post?u=8aeb20a530e124561927d3bd8&amp;id=8c3d2d214b" method="post" name="mc-embedded-subscribe-form" class="wj-contact-form validate" target="_blank" novalidate>
            <div class="mc-field-group d-inline-flex">
            <input type="email" placeholder="Your e-mail" name="EMAIL" class="required email" id="mce-EMAIL" autocomplete="on" required>
            <input type="submit" value="Subscribe" name="subscribe" class="heart">
            </div>
        </form>
    </div>
    
    
</div>

<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-12 text-center text-lg-left">
                Copyright © 2021 Tuyen Nguyen 
            </div>
            <div class="col-md-6 col-sm-12 text-center text-lg-right">    
                <a target="_blank" href="https://www.wowthemes.net/memoirs-free-jekyll-theme/">Memoirs Jekyll Theme</a> by WowThemes.net
            </div>
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

</div> <!-- /.site-content -->

<!-- Scripts (if you need bootstrap.js, please add it yourself. I didn't use it for performance reasons, it was not needed in this theme)
================================================== -->

<script src="https://tuyen-nnt.github.io/assets/js/prism.js"></script>

<script src="https://tuyen-nnt.github.io/assets/js/theme.js"></script>




<script id="dsq-count-scr" src="//demowebsite.disqus.com/count.js"></script>


</body>
</html>
